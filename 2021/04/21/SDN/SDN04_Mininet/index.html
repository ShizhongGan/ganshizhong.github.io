<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>软件定义网络（SDN）学习笔记(4)--Mininet | 甘士忠个人博客</title>
  <meta name="description" content="Mininet简洁Mininet是基于Linux C ontainer架构开发的一个进程虚拟化网络仿真工具，可以创建一个含有主机、交换机、控制器和链路的虚拟网络，其交换机支持OpenFlow，具有高度灵活的自定义软件定义网络。Mininet可以用一个命令在一台主机上（虚拟机、云或者本地）以秒级创建一个虚拟网络，并在上面运行真正的内核、交换机和应用程序代码。Mininet能实现如下功能：  为Ope">
<meta property="og:type" content="article">
<meta property="og:title" content="软件定义网络（SDN）学习笔记(4)--Mininet">
<meta property="og:url" content="http://shizhonggan.github.io/2021/04/21/SDN/SDN04_Mininet/index.html">
<meta property="og:site_name" content="钟声">
<meta property="og:description" content="Mininet简洁Mininet是基于Linux C ontainer架构开发的一个进程虚拟化网络仿真工具，可以创建一个含有主机、交换机、控制器和链路的虚拟网络，其交换机支持OpenFlow，具有高度灵活的自定义软件定义网络。Mininet可以用一个命令在一台主机上（虚拟机、云或者本地）以秒级创建一个虚拟网络，并在上面运行真正的内核、交换机和应用程序代码。Mininet能实现如下功能：  为Ope">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ganshizhong.gitee.io/blogimages/SDN/mininet/controller.png">
<meta property="og:image" content="https://ganshizhong.gitee.io/blogimages/SDN/mininet/switch.png">
<meta property="og:image" content="https://ganshizhong.gitee.io/blogimages/SDN/mininet/h1.png">
<meta property="og:image" content="https://ganshizhong.gitee.io/blogimages/SDN/mininet/link.png">
<meta property="og:image" content="https://ganshizhong.gitee.io/blogimages/SDN/mininet/preferences.png">
<meta property="og:image" content="https://ganshizhong.gitee.io/blogimages/SDN/mininet/detail.png">
<meta property="og:image" content="https://ganshizhong.gitee.io/blogimages/SDN/mininet/wireshark.png">
<meta property="og:image" content="https://ganshizhong.gitee.io/blogimages/SDN/mininet/topo1.png">
<meta property="article:published_time" content="2021-04-21T13:31:04.000Z">
<meta property="article:modified_time" content="2021-10-28T06:55:59.906Z">
<meta property="article:author" content="甘士忠">
<meta property="article:tag" content="SDN">
<meta property="article:tag" content="OVS">
<meta property="article:tag" content="网络架构">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ganshizhong.gitee.io/blogimages/SDN/mininet/controller.png">
  <!-- Canonical links -->
  <link rel="canonical" href="http://shizhonggan.github.io/2021/04/21/SDN/SDN04_Mininet/index.html">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="钟声" type="application/atom+xml">
</head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">

  
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img class="img-circle img-rotate" src="https://ganshizhong.gitee.io/blogimages/HexoSource/me.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">甘士忠</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Sharing is meaningful.</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Beijing, China</small>
      </div>
      
      
        <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        

        
          <li class="menu-item menu-item-home">
            <a href="/.">
              
              <i class="icon icon-home-fill"></i>
              
              <span class="menu-title">首页</span>
            </a>
          </li>
        

        <!-- <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li> -->
        
        

        
          <li class="menu-item menu-item-archives">
            <a href="/archives">
              
              <i class="icon icon-archives-fill"></i>
              
              <span class="menu-title">归档</span>
            </a>
          </li>
        

        <!-- <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li> -->
        
        

        
          <li class="menu-item menu-item-categories">
            <a href="/categories">
              
              <i class="icon icon-folder"></i>
              
              <span class="menu-title">分类</span>
            </a>
          </li>
        

        <!-- <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li> -->
        
        

        
          <li class="menu-item menu-item-tags">
            <a href="/tags">
              
              <i class="icon icon-tags"></i>
              
              <span class="menu-title">标签</span>
            </a>
          </li>
        

        <!-- <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li> -->
        
        

        
          <li class="menu-item menu-item-about">
            <a href="/about">
              
              <i class="icon icon-cup-fill"></i>
              
              <span class="menu-title">关于</span>
            </a>
          </li>
        

        <!-- <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li> -->
        
        

        
          <li class="menu-item menu-item-cv" style="display:none;">
            <a href="/cv">
              
              <i class="icon icon-file"></i>
              
              <span class="menu-title">简历</span>
            </a>
          </li>
        

        <!-- <li class="menu-item menu-item-cv">
          <a href="/cv">
            
            <i class="icon icon-file"></i>
            
            <span class="menu-title">简历</span>
          </a>
        </li> -->
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/shizhonggan" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://gitee.com/ganshizhong" target="_blank" title="Gitee" data-toggle=tooltip data-placement=top><i class="icon icon-gitee"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
  
  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!QQ号：1358206080</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AWS/">AWS</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ansible/">Ansible</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/BigData/">BigData</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/BigData/Hadoop/">Hadoop</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/BigData/Spark/">Spark</a><span class="category-list-count">4</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Deep-Learning/">Deep Learning</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DevOps/">DevOps</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Django/">Django</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ELK/">ELK</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mininet/">Mininet</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nvidia/">Nvidia</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SDN/">SDN</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SQL/">SQL</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tips/">Tips</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/">开发</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%BB%9C/">网络</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BF%90%E7%BB%B4/">运维</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/API/" style="font-size: 13px;">API</a> <a href="/tags/AWS/" style="font-size: 13px;">AWS</a> <a href="/tags/Ansible/" style="font-size: 13.14px;">Ansible</a> <a href="/tags/Ansilbe/" style="font-size: 13px;">Ansilbe</a> <a href="/tags/DevOps/" style="font-size: 14px;">DevOps</a> <a href="/tags/Django/" style="font-size: 13.29px;">Django</a> <a href="/tags/Docker/" style="font-size: 13.57px;">Docker</a> <a href="/tags/ELK/" style="font-size: 13.71px;">ELK</a> <a href="/tags/Elasticsearch/" style="font-size: 13.14px;">Elasticsearch</a> <a href="/tags/Few-shot-Learning/" style="font-size: 13px;">Few-shot Learning</a> <a href="/tags/Floodlight/" style="font-size: 13px;">Floodlight</a> <a href="/tags/Gitee/" style="font-size: 13px;">Gitee</a> <a href="/tags/Hexo/" style="font-size: 13.14px;">Hexo</a> <a href="/tags/JumpServer/" style="font-size: 13px;">JumpServer</a> <a href="/tags/Logstash/" style="font-size: 13px;">Logstash</a> <a href="/tags/Mysql/" style="font-size: 13px;">Mysql</a> <a href="/tags/Nagios/" style="font-size: 13.29px;">Nagios</a> <a href="/tags/Netperf/" style="font-size: 13px;">Netperf</a> <a href="/tags/Nginx/" style="font-size: 13.29px;">Nginx</a> <a href="/tags/Nvidia/" style="font-size: 13px;">Nvidia</a> <a href="/tags/OOP/" style="font-size: 13px;">OOP</a> <a href="/tags/OVS/" style="font-size: 13.57px;">OVS</a> <a href="/tags/OpenDaylight/" style="font-size: 13.14px;">OpenDaylight</a> <a href="/tags/Postman/" style="font-size: 13px;">Postman</a> <a href="/tags/PyQt5/" style="font-size: 13px;">PyQt5</a> <a href="/tags/Python/" style="font-size: 13px;">Python</a> <a href="/tags/RESTful/" style="font-size: 13px;">RESTful</a> <a href="/tags/RESTful-API/" style="font-size: 13px;">RESTful API</a> <a href="/tags/SDN/" style="font-size: 13.71px;">SDN</a> <a href="/tags/Scapy/" style="font-size: 13px;">Scapy</a> <a href="/tags/Semi-Supervised-Learning/" style="font-size: 13px;">Semi-Supervised Learning</a> <a href="/tags/Shell-commands/" style="font-size: 13px;">Shell commands</a> <a href="/tags/boto3/" style="font-size: 13px;">boto3</a> <a href="/tags/coroutine/" style="font-size: 13px;">coroutine</a> <a href="/tags/devops/" style="font-size: 13.14px;">devops</a> <a href="/tags/django/" style="font-size: 13.14px;">django</a> <a href="/tags/docker/" style="font-size: 13.14px;">docker</a> <a href="/tags/gitalk/" style="font-size: 13.14px;">gitalk</a> <a href="/tags/gitlab/" style="font-size: 13px;">gitlab</a> <a href="/tags/hexo/" style="font-size: 13.14px;">hexo</a> <a href="/tags/iPerf/" style="font-size: 13px;">iPerf</a> <a href="/tags/paramiko/" style="font-size: 13.14px;">paramiko</a> <a href="/tags/process/" style="font-size: 13px;">process</a> <a href="/tags/python/" style="font-size: 13.86px;">python</a> <a href="/tags/python3/" style="font-size: 13.14px;">python3</a> <a href="/tags/thread/" style="font-size: 13px;">thread</a> <a href="/tags/tkinter/" style="font-size: 13px;">tkinter</a> <a href="/tags/vs-code%E6%8F%92%E4%BB%B6/" style="font-size: 13px;">vs code插件</a> <a href="/tags/zabbix/" style="font-size: 13.14px;">zabbix</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 13.14px;">前端</a> <a href="/tags/%E5%90%8E%E7%AB%AF/" style="font-size: 13px;">后端</a> <a href="/tags/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/" style="font-size: 13.14px;">性能测试</a> <a href="/tags/%E6%B8%B8%E6%A0%87/" style="font-size: 13px;">游标</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 13.14px;">网络</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84/" style="font-size: 13.43px;">网络架构</a> <a href="/tags/%E8%BF%90%E7%BB%B4/" style="font-size: 13.14px;">运维</a> <a href="/tags/%E9%82%A3%E4%BA%9B%E5%9D%91/" style="font-size: 13px;">那些坑</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 13px;">面试</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">四月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">七月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">17</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/BigData/">BigData</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/BigData/Spark/">Spark</a>
              </p>
              <p class="item-title">
                <a href="/2022/05/18/BigData/SparkDeploy/" class="title">Spark部署</a>
              </p>
              <p class="item-date">
                <time datetime="2022-05-18T07:54:23.000Z" itemprop="datePublished">2022-05-18</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/BigData/">BigData</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/BigData/Spark/">Spark</a>
              </p>
              <p class="item-title">
                <a href="/2022/05/18/BigData/SparkStandAloneHA/" class="title">Spark StandAlone HA集群搭建</a>
              </p>
              <p class="item-date">
                <time datetime="2022-05-18T07:54:23.000Z" itemprop="datePublished">2022-05-18</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/BigData/">BigData</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/BigData/Hadoop/">Hadoop</a>
              </p>
              <p class="item-title">
                <a href="/2022/05/17/BigData/hadoop_installerror/" class="title">Hadoop安装常见错误</a>
              </p>
              <p class="item-date">
                <time datetime="2022-05-17T07:54:23.000Z" itemprop="datePublished">2022-05-17</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/BigData/">BigData</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/BigData/Spark/">Spark</a>
              </p>
              <p class="item-title">
                <a href="/2022/05/14/BigData/SparkStandalone/" class="title">Hadoop 部署</a>
              </p>
              <p class="item-date">
                <time datetime="2022-05-14T07:54:23.000Z" itemprop="datePublished">2022-05-14</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/BigData/">BigData</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/BigData/Spark/">Spark</a>
              </p>
              <p class="item-title">
                <a href="/2022/05/01/BigData/SparkOverview/" class="title">Spark框架概述</a>
              </p>
              <p class="item-date">
                <time datetime="2022-05-01T07:54:23.000Z" itemprop="datePublished">2022-05-01</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<main class="main" role="main">
  <div class="content">
  <article id="post-SDN/SDN04_Mininet" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      软件定义网络（SDN）学习笔记(4)--Mininet
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/04/21/SDN/SDN04_Mininet/" class="article-date">
	  <time datetime="2021-04-21T13:31:04.000Z" itemprop="datePublished">2021-04-21</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/SDN/">SDN</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link-link" href="/tags/OVS/" rel="tag">OVS</a>, <a class="article-tag-link-link" href="/tags/SDN/" rel="tag">SDN</a>, <a class="article-tag-link-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84/" rel="tag">网络架构</a>
  </span>


        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>


        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/04/21/SDN/SDN04_Mininet/#comments" class="article-comment-link">评论</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h2 id="Mininet简洁"><a href="#Mininet简洁" class="headerlink" title="Mininet简洁"></a>Mininet简洁</h2><p>Mininet是基于Linux C ontainer架构开发的一个进程虚拟化网络仿真工具，可以创建一个含有主机、交换机、控制器和链路的虚拟网络，其交换机支持OpenFlow，具有高度灵活的自定义软件定义网络。Mininet可以用一个命令在一台主机上（虚拟机、云或者本地）以秒级创建一个虚拟网络，并在上面运行真正的内核、交换机和应用程序代码。<br>Mininet能实现如下功能：</p>
<ul>
<li>为OpenFlow应用程序提供一个简单、便宜的网络测试平台</li>
<li>启用复杂的拓扑测试，无需连接物理网络</li>
<li>具有拓扑感知和OpenFlow感知的CLI，用于调试或运行网络范围的测试</li>
<li>支持任意自定义拓扑，主机数可达4096，并包括一组基本的参数化拓扑</li>
<li>提供用于网络创建和实验的可扩展Python API</li>
</ul>
<p>Miniedit可视化，直接在界面上编辑任意拓扑，生成python自定义拓扑脚本，使用Mininet可视化界面方便了用户自定义拓扑创建，为不熟悉python脚本的使用者创造了更简单的环境，界面直观，可操作性强。</p>
<p>Mininet 2.2.0+内置miniedit 。在mininet/examples下提供miniedit.py脚本，执行脚本后显示可视化界面，可自定义拓扑及配置属性。<br>MiniEdit使用主要分三个步骤：Miniedit启动→自定义创建拓扑，设置设备信息→运行拓扑并生成拓扑脚本。</p>
<h2 id="Mininet-安装与卸载"><a href="#Mininet-安装与卸载" class="headerlink" title="Mininet 安装与卸载"></a>Mininet 安装与卸载</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">git <span class="built_in">clone</span> http://github.com/mininet/mininet.git</span><br><span class="line"><span class="built_in">cd</span> mininet ``</span><br><span class="line">cat INSTALL|more</span><br><span class="line"><span class="built_in">cd</span> util/</span><br><span class="line"><span class="comment">## 安装</span></span><br><span class="line">./install.sh -a</span><br><span class="line"><span class="comment">## 检查是否成功</span></span><br><span class="line">mn --<span class="built_in">test</span> pingall</span><br><span class="line"><span class="comment">## 查看版本</span></span><br><span class="line">mn --version</span><br><span class="line"></span><br><span class="line"><span class="comment">## 卸载</span></span><br><span class="line">sudo rm -rf /usr/<span class="built_in">local</span>/bin/mn  /usr/<span class="built_in">local</span>/bin/mnexec /usr/<span class="built_in">local</span>/lib/python*/*/*mininet* /usr/<span class="built_in">local</span>/bin/ovs-* /usr/<span class="built_in">local</span>/sbin/ovs-*</span><br><span class="line">sudo apt-get remove mininet</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dpkg 报错 参考：https://www.bbsmax.com/A/MyJx7MvVzn/</span></span><br><span class="line">sudo mv /var/lib/dpkg/info/ /var/lib/dpkg/info_old/</span><br><span class="line">sudo mkdir /var/lib/dpkg/info/</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get -f install</span><br><span class="line">sudo mv /var/lib/dpkg/info/* /var/lib/dpkg/info_old/</span><br><span class="line">sudo rm -rf /var/lib/dpkg/info</span><br><span class="line">sudo mv /var/lib/dpkg/info_old/ /var/lib/dpkg/info/</span><br><span class="line">sudo apt-get update </span><br><span class="line">sudo apt-get upgrade </span><br><span class="line"></span><br><span class="line"><span class="comment">## 或者 这个方法不行，但有说成功的... </span></span><br><span class="line"><span class="comment"># https://blog.csdn.net/ljf_study/article/details/81591036</span></span><br><span class="line">sudo apt-get autoremove</span><br><span class="line">sudo apt-get --purge remove &amp;&amp; sudo apt-get autoclean</span><br><span class="line">sudo apt-get -f install</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade &amp;&amp; sudo apt-get dist-upgrade</span><br><span class="line">sudo dpkg-reconfigure -a</span><br><span class="line">sudo dpkg --configure -a</span><br></pre></td></tr></table></figure>

<h2 id="Mininet拓朴构建与命令使用"><a href="#Mininet拓朴构建与命令使用" class="headerlink" title="Mininet拓朴构建与命令使用"></a>Mininet拓朴构建与命令使用</h2><p>topo：用于指定网络拓扑，Mininet支持创建的网络拓扑为：minimal、single、linear和tree。</p>
<ul>
<li>minimal：创建一个交换机和两个主机相连的简单拓扑。默认无—topo参数的情况下就是这样。其内部实现就是调用了single,2对应的函数。</li>
<li>single,n：设置一个交换机和n个主机相连的拓扑。</li>
<li>linear,n：创建n个交换机，每个交换机只连接一个主机，并且所有交换机成线型排列。</li>
<li>tree,depth=n,fanout=m：创建深度为n，每层树枝为m的树型拓扑。因此形成的拓扑的交换机个数为（mn-1）/（m-1），主机个数为mn。</li>
<li>–custom：在上述已有拓扑的基础上，Mininet支持自定义的拓扑，使用一个简单的Python API即可。—custom需和—topo一起使用，如mn —custom file.py -topo mytopo。</li>
</ul>
<h3 id="网络构建参数使用"><a href="#网络构建参数使用" class="headerlink" title="网络构建参数使用"></a>网络构建参数使用</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建single拓扑</span></span><br><span class="line">sudo mn --topo=single,3</span><br><span class="line"><span class="built_in">exit</span> <span class="comment"># 退出 </span></span><br><span class="line"><span class="comment"># 创建linear线性拓扑</span></span><br><span class="line">sudo mn --topo=linear,3</span><br><span class="line"><span class="comment"># 创建tree树形拓扑，深度2，每个交换机下挂两个设备</span></span><br><span class="line">sudo mn --topo=tree,depth=2,fanout=2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建custom自定义拓扑</span></span><br><span class="line"><span class="built_in">cd</span> /home/openlab/openlab/mininet/custom</span><br><span class="line">sudo mn --custom topo-2sw-2host.py --topo mytopo</span><br><span class="line"><span class="comment">#自定义（custom）拓扑指python编写文件file.py，执行此脚本即可创建定义的拓扑，—custom与—topo联用，在custom目录下存在topo-2sw-2host.py文件，本例调用此文件构建拓扑。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 设置交换机</span></span><br><span class="line">--switch=Switch <span class="comment"># 默认ovsk，还包括user,ovsbr,ovsk,ivs和lxbr</span></span><br><span class="line"><span class="comment">## 配置MAC地址，</span></span><br></pre></td></tr></table></figure>

<h3 id="内部交互命令使用"><a href="#内部交互命令使用" class="headerlink" title="内部交互命令使用"></a>内部交互命令使用</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">net <span class="comment"># 显示链接信息</span></span><br><span class="line">nodes <span class="comment"># 查看节点信息</span></span><br><span class="line">links <span class="comment"># 查看链路健壮性信息</span></span><br><span class="line">pingall <span class="comment"># 验证所有主机间通信并查看结果</span></span><br><span class="line">xterm h1 h2 <span class="comment"># 开启xterm进入设备可视化操作界面</span></span><br><span class="line"><span class="built_in">exit</span> <span class="comment"># 退出</span></span><br><span class="line">mn -c <span class="comment"># 清除释放Mininet构造配置的交换机及主机</span></span><br></pre></td></tr></table></figure>

<h3 id="可视化构建网络拓扑"><a href="#可视化构建网络拓扑" class="headerlink" title="可视化构建网络拓扑"></a>可视化构建网络拓扑</h3><ul>
<li><p>启动</p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> mininet/examples <span class="comment"># 进入该目录下</span></span><br><span class="line">sudo ./miniedit.py <span class="comment"># 启动可视化界面</span></span><br></pre></td></tr></table></figure></li>
<li><p>Miniedit拓扑建立：选择左侧的网络组件，在空白区域单击鼠标左键即可添加网络组件，可选择的组件主要有主机、OpenFlow交换机、传统交换机，传统路由器、链路、控制器。</p>
</li>
<li><p>Miniedit拓扑建立：选择左侧的网络组件，在空白区域单击鼠标左键即可添加网络组件，可选择的组件主要有主机、OpenFlow交换机、传统交换机，传统路由器、链路、控制器。</p>
</li>
<li><p>Miniedit全局配置：Miniedit左上角“Edit”中可以剪切删除设备，及对整个网络进行全局配置</p>
</li>
<li><p>Miniedit运行：点击左下角“run”，即可运行设置好的网络拓扑，同时在后台可以看到相应的配置信息。运行后对交换机、主机进行右击长按，可查看交换机的bridge信息及打开Host的终端</p>
</li>
<li><p>Miniedit保存脚本：miniedit设置好拓扑后，可通过选择File-Export Level 2 Script，将其保存为python脚本，默认在mininet/examples目录下，通过chmod给此脚本权限后，直接运行即可重现拓扑</p>
</li>
<li><p>Miniedit脚本执行</p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过后台查看保存的sdnlab.py脚本文件，并给脚本赋予权限：</span></span><br><span class="line">chmod –R 777 sdnlab.py</span><br><span class="line"><span class="comment"># 执行sdnlab.py脚本：</span></span><br><span class="line">./sdnlab.py</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Mininet-调用API扩展自定义拓扑"><a href="#Mininet-调用API扩展自定义拓扑" class="headerlink" title="Mininet 调用API扩展自定义拓扑"></a>Mininet 调用API扩展自定义拓扑</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> mininet/custom </span><br><span class="line">sudo mn --custom topo-2sw-2host.py --topo mytopo <span class="comment"># 执行</span></span><br><span class="line">py net.addHost(<span class="string">&#x27;h3&#x27;</span>) <span class="comment"># 添加主机h3</span></span><br><span class="line">py net.addLink(s3,net.get(<span class="string">&#x27;h3&#x27;</span>)) <span class="comment"># 添加s3与h3之间的链路</span></span><br><span class="line">py s3.attach(<span class="string">&#x27;s3-eth3&#x27;</span>) <span class="comment"># s3添加接口</span></span><br><span class="line">py net.get(<span class="string">&#x27;h3&#x27;</span>).cmd(<span class="string">&#x27;ifconfig h3-eth0 10.3&#x27;</span>) <span class="comment"># 配置h3的IP地址</span></span><br><span class="line"><span class="comment">## 查看节点信息</span></span><br><span class="line">dump</span><br><span class="line">nodes </span><br><span class="line"><span class="comment">## 检查连通性</span></span><br><span class="line">h1 ping h3</span><br><span class="line">pingall</span><br></pre></td></tr></table></figure>

<h2 id="Mininet可视化构建网络拓扑"><a href="#Mininet可视化构建网络拓扑" class="headerlink" title="Mininet可视化构建网络拓扑"></a>Mininet可视化构建网络拓扑</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 报错 MoTTY X11 proxy: Unsupported authorisation protocol</span></span><br><span class="line"><span class="comment">## 需要普通用户下执行</span></span><br><span class="line"><span class="built_in">cd</span> mininet/mininet/examples</span><br><span class="line">sudo ./miniedit.py</span><br></pre></td></tr></table></figure>

<ul>
<li><p>在控制器上进行鼠标右击长按，选择Properties即可对控制器进行配置，如下所示</p>
<p>  <img src="https://ganshizhong.gitee.io/blogimages/SDN/mininet/controller.png" alt="controller properties"></p>
</li>
<li><p>在交换机上进行鼠标右击长按，选择Properties即可对交换机进行配置，交换机属性需配置16位的DPID，如下所示:</p>
<p>  <img src="https://ganshizhong.gitee.io/blogimages/SDN/mininet/switch.png" alt="controller properties"></p>
</li>
<li><p>在主机上进行鼠标右击长按，选择Properties即可对主机进行配置，主机属性需配置IP地址，如下所示。</p>
<p>  <img src="https://ganshizhong.gitee.io/blogimages/SDN/mininet/h1.png" alt="controller properties"></p>
</li>
<li><p>也可对链路进行属性配置，主要配置带宽、时延、丢包率等，此项可配置亦可不配置，如下所示:</p>
<p>  <img src="https://ganshizhong.gitee.io/blogimages/SDN/mininet/link.png" alt="controller properties"></p>
</li>
<li><p>Miniedit全局配置。Miniedit左上角“Edit”中可以剪切删除设备，及对整个网络进行全局配置，如下所示。</p>
<p>  <img src="https://ganshizhong.gitee.io/blogimages/SDN/mininet/preferences.png" alt="controller properties"></p>
</li>
<li><p>Miniedit运行。</p>
<ul>
<li><p>单击左下角“run”，即可运行设置好的网络拓扑，同时在后台可以看到相应的配置信息。</p>
</li>
<li><p>运行后对交换机、主机进行右击长按，可查看交换机的bridge信息及打开Host的终端，交换机信息如下：</p>
<p><img src="https://ganshizhong.gitee.io/blogimages/SDN/mininet/detail.png" alt="controller properties"></p>
</li>
</ul>
</li>
<li><p>Miniedit保存脚本。Miniedit设置好拓扑后，可通过选择“File &gt; Export Level 2 Script”，将其保存为python脚本，默认在mininet/examples目录下。</p>
</li>
<li><p>Miniedit脚本执行。</p>
<ul>
<li>通过后台查看保存的sdnlab.py脚本文件，并给脚本赋予权限：</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod -R 777 sdnlab.py</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Mininet流表应用1——手动添加流表"><a href="#Mininet流表应用1——手动添加流表" class="headerlink" title="Mininet流表应用1——手动添加流表"></a>Mininet流表应用1——手动添加流表</h2><h3 id="创建拓扑"><a href="#创建拓扑" class="headerlink" title="创建拓扑"></a>创建拓扑</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">vim ./custom/exper1.py</span><br><span class="line"><span class="meta">#!/usr/bin/python</span></span><br><span class="line">from mininet.topo import Topo</span><br><span class="line">from mininet.net import Mininet</span><br><span class="line">from mininet.node import RemoteController</span><br><span class="line">from mininet.link import TCLink</span><br><span class="line">from mininet.util import dumpNodeConnections</span><br><span class="line">class MyTopo( Topo ):</span><br><span class="line">    <span class="string">&quot;Simple topology example.&quot;</span></span><br><span class="line">    def __init__( self ):</span><br><span class="line">        <span class="string">&quot;Create custom topo.&quot;</span></span><br><span class="line">        <span class="comment"># Initialize topology</span></span><br><span class="line">        Topo.__init__( self )</span><br><span class="line">        <span class="comment"># Add hosts and switches</span></span><br><span class="line">        Host1 = self.addHost( <span class="string">&#x27;h1&#x27;</span> )</span><br><span class="line">        Host2 = self.addHost( <span class="string">&#x27;h2&#x27;</span> )</span><br><span class="line">        Host3 = self.addHost( <span class="string">&#x27;h3&#x27;</span> )</span><br><span class="line">        Switch1 = self.addSwitch( <span class="string">&#x27;s1&#x27;</span> )</span><br><span class="line">        Switch2 = self.addSwitch( <span class="string">&#x27;s2&#x27;</span> )</span><br><span class="line">        <span class="comment"># Add links</span></span><br><span class="line">        self.addLink( Host1, Switch1 )</span><br><span class="line">        self.addLink( Host2, Switch1 )</span><br><span class="line">        self.addLink( Host3, Switch2 )</span><br><span class="line">        self.addLink( Switch1, Switch2 )</span><br><span class="line">topos = &#123; <span class="string">&#x27;mytopo&#x27;</span>: ( lambda: MyTopo() ) &#125;</span><br><span class="line"><span class="comment">## </span></span><br><span class="line"><span class="comment"># 运行自定义脚本，并指定一个不存在的控制器，是交换机不受控制器控制</span></span><br><span class="line">sudo mn --custom exper1.py --topo mytopo --controller=remote,ip=127.0.0.1,port=6633</span><br></pre></td></tr></table></figure>

<h3 id="测试流表状态下的通信"><a href="#测试流表状态下的通信" class="headerlink" title="测试流表状态下的通信"></a>测试流表状态下的通信</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">xterm h1 h2 h3 <span class="comment"># 打开可视化终端</span></span><br><span class="line">dpctl dump-flows <span class="comment"># 查看交换机的flow table信息，可以看到没有流表</span></span><br><span class="line">mininet&gt; dpctl dump-flows</span><br><span class="line">*** s1 -------------------------</span><br><span class="line">*** s2 -------------------------</span><br><span class="line"><span class="comment">## 在主机h2中执行命令tcpdump -n -i h2-eth0抓取网卡h2-eth0上的数据包</span></span><br><span class="line">root@sdntest:~/mininet/custom<span class="comment"># tcpdump -n -i h2-eth0</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on h2-eth0, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line"><span class="comment">## 在主机h3中执行命令tcpdump -n -i h3-eth0抓取网卡h2-eth0上的数据包,结果同上</span></span><br><span class="line"><span class="comment">## 在主机h1中执行如下命令分别ping主机h2和h3，结果如下：</span></span><br><span class="line">PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.</span><br><span class="line">From 10.0.0.1 icmp_seq=1 Destination Host Unreachable</span><br><span class="line">From 10.0.0.1 icmp_seq=2 Destination Host Unreachable</span><br><span class="line">From 10.0.0.1 icmp_seq=3 Destination Host Unreachable</span><br><span class="line"></span><br><span class="line">--- 10.0.0.2 ping statistics ---</span><br><span class="line">3 packets transmitted, 0 received, +3 errors, 100% packet loss, time 1999ms</span><br><span class="line">pipe 3</span><br></pre></td></tr></table></figure>

<h3 id="添加流表并测试主机间的通信"><a href="#添加流表并测试主机间的通信" class="headerlink" title="添加流表并测试主机间的通信"></a>添加流表并测试主机间的通信</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 步骤1 执行如下命令添加交换机端口流表使主机h1和h2通信</span></span><br><span class="line">mininet&gt; dpctl add-flow in_port=1,actions=output:2</span><br><span class="line">dpctl add-flow in_port=2,actions=output:1</span><br><span class="line"><span class="comment"># 步骤2 执行如下命令查看交换机流表，两条flow entry添加成功</span></span><br><span class="line">mininet&gt; dpctl dump-flows</span><br><span class="line"><span class="comment"># 步骤3 在主机h1中执行如下命令分别ping主机h2和h3</span></span><br></pre></td></tr></table></figure>

<p>可以看到主机h1成功ping通h2，且h3没收到任何ping包。原理解析：用dpctl对交换机添加flow，让交换机从s1-eth1这个端口接收到的所有traffic都从s1-eth2这个端口发出去。用dpctl给交换机添加双向流表，因为ping包除了echo request还有echo reply。所以还需要用dpctl对交换机添加flow，让交换机从s1-eth2这个端口接收到的所有traffic都从s1-eth1这个端口发出去。添加这两条flow后，h1能够ping通h2，但是并没有为h1和h3之间添加对应的端口流表，所以h1与h3不通。</p>
<h2 id="添加协议流表使h1-h2通信"><a href="#添加协议流表使h1-h2通信" class="headerlink" title="添加协议流表使h1/h2通信"></a>添加协议流表使h1/h2通信</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 步骤1 执行如下命令删除之前通过端口添加的流表并查看流表，确保交换机flow table为空</span></span><br><span class="line">dpctl del-flows</span><br><span class="line">dpctl dump-flows</span><br><span class="line"><span class="comment"># 步骤2 执行如下命令添加两条traffic类型为IPv4（0x0800）协议相关的flow entry，并查看下发的流表。</span></span><br><span class="line">dpctl add-flow dl_type=0x0800,nw_dst=10.0.0.2,actions=output:2</span><br><span class="line">dpctl add-flow dl_type=0x0800,nw_dst=10.0.0.1,actions=output:1</span><br><span class="line">dpctl dump-flows</span><br><span class="line"><span class="comment"># 步骤3 在主机h1中执行如下命令分别ping主机h2和h3</span></span><br><span class="line">ping -c 3 10.0.0.2</span><br><span class="line">ping -c 3 10.0.0.3</span><br><span class="line"><span class="comment"># 步骤4 在主机h2和h3 上查看tcpdump抓包结果</span></span><br></pre></td></tr></table></figure>

<p>原理解析：用dpctl对交换机添加flow，让交换机把所有EtherType为0x0800（IPv4）并且destiation IP为10.0.0.2的traffic从s1-eth2这个端口发出去。用dpctl对交换机添加flow，让交换机把所有EtherType为0x0800（IPv4）并且destiation IP为10.0.0.1的traffic从s1-eth1这个端口发出去。但处在同一网段下的主机，它们之间的交流是L2 forwarding，需要靠ARP来解析MAC地址，之前只匹配了0x0800(IPv4)协议，并没有匹配到0x0806(ARP)，这样当交换机收到h1的ARP包后，因为没有控制器，flow table里面也没有相应的flow告诉它如何转发这个ARP包，交换机只能将它丢弃，从而导致h1 ping h2失败，所以需要添加ARP协议的流表来使通信。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 步骤5 执行命令添加ARP（0x0806）协议相关的流表，让交换机以NORMAL形式（即广播）将所有ARP包从各个端口广播出去</span></span><br><span class="line">dpctl add-flow dl_type=0x0806,actions=NORMAL</span><br><span class="line">dpctl dump-flows</span><br><span class="line"><span class="comment">## 然后 h1可以ping通h2</span></span><br></pre></td></tr></table></figure>

<h2 id="Mininet流表应用实战2"><a href="#Mininet流表应用实战2" class="headerlink" title="Mininet流表应用实战2"></a>Mininet流表应用实战2</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 步骤1 登录OpenDaylight虚拟机，执行如下命令查看OpenDaylight的启动情况，端口监听情况如下所示</span></span><br><span class="line">netstat -anput|grep 6653</span><br><span class="line">netstat -anput|grep 8181</span><br><span class="line"></span><br><span class="line">./bin/karaf</span><br><span class="line">feature:install odl-l2switch-switch-ui odl-openflowplugin-flow-services-ui odl-mdsal-apidocs odl-dluxapps-applications odl-faas-all</span><br><span class="line"></span><br><span class="line">feature:install odl-restconf</span><br><span class="line">feature:install odl-l2switch-switch-ui</span><br><span class="line">feature:install odl-openflowplugin-flow-services-ui</span><br><span class="line">feature:install odl-mdsal-apidocs</span><br><span class="line">feature:install odl-dluxapps-applications</span><br><span class="line">feature:install odl-faas-all</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤2 mininet虚拟机打开wireshark进行抓包，监听网卡any</span></span><br><span class="line">sudo wireshark</span><br><span class="line"><span class="comment"># 步骤3 </span></span><br><span class="line">sudo mn --custom exper1.py --topo mytopo --controller=remote,ip=119.255.243.31,port=6633 --switch ovs,protocols=OpenFlow13 <span class="comment"># 这个1.3协议得设置 不然总失败，或1.1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤4 执行命令pingall验证Mininet中虚拟主机的连通性</span></span><br><span class="line"><span class="comment"># 步骤5 执行命令dpctl dump-flows查看交换机上的流表</span></span><br></pre></td></tr></table></figure>

<figure class="highlight mk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">error: ovs-ofctl：version negotiation failed (we support version 0x01, peer supports version 0x04) 查看ovs中的流表时报错。原因是ovs-ofctl dump-flows命令默认是1.0版本，需要在命令中指定OpenFlow版本</span></span><br><span class="line"></span><br><span class="line">sudo ovs-ofctl dump-flows -O OpenFlow13 s1 <span class="comment"># ovs</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 步骤6 停止Wireshark抓包并查看抓包结果，筛选出openflow_v4协议数据包，如下图</span></span><br><span class="line"><span class="comment"># 步骤7 打开odl控制器可以看到拓扑图如下</span></span><br></pre></td></tr></table></figure>

<p><img src="https://ganshizhong.gitee.io/blogimages/SDN/mininet/wireshark.png" alt="controller properties"></p>
<p><img src="https://ganshizhong.gitee.io/blogimages/SDN/mininet/topo1.png" alt="controller properties"></p>
<h3 id="OpenFlow协议解析"><a href="#OpenFlow协议解析" class="headerlink" title="OpenFlow协议解析"></a>OpenFlow协议解析</h3><ul>
<li>步骤1 首先发送HELLO消息，建立初始化连接，协商使用的OpenFlow协议版本。由下图可知，ODL与Mininet之间应用的是OpenFlow1.0版本协议。</li>
<li>步骤2 OpenFlow版本协商完成后，控制器发送一条features_request消息获取交换机的特性信息，包括交换机的ID（DPID）、缓冲区数量、端口及端口属性等等。相应的，交换机回复features_reply消息。ofpt_feature_reply数据包详情如下，交换机的DPID是数据通道独一无二的标识符。本实验中交换机缓冲区数量（n_buffers）为256，交换机支持的流表数量（n_tables）为254，交换机所支持的功能，如下所示。</li>
<li>步骤3 stats reply消息用于回应stats request信息，主要是交换机回应给控制器的状态信息</li>
<li>步骤4 当交换机收到数据包后查找流表无匹配项时，将数据包封装在packet_in消息发给控制器，由控制器通过packet_out消息下发决策，使发送和接收数据包的两主机间进行通信。</li>
<li>步骤5 flow mod消息涉及流表项的下发匹配信息，下图显示的是flow mod匹配项的类型信息。</li>
</ul>
<h2 id="Mininet-多数据中心网络拓扑流量带宽实验"><a href="#Mininet-多数据中心网络拓扑流量带宽实验" class="headerlink" title="Mininet 多数据中心网络拓扑流量带宽实验"></a>Mininet 多数据中心网络拓扑流量带宽实验</h2><h3 id="实验内容"><a href="#实验内容" class="headerlink" title="实验内容"></a>实验内容</h3><ol>
<li>通过Mininet模拟搭建基于不同数据中心的网络拓扑。</li>
<li>通过程序生成真实网络流量。</li>
</ol>
<h3 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h3><h4 id="数据中心基础"><a href="#数据中心基础" class="headerlink" title="数据中心基础"></a>数据中心基础</h4><p>数据中心不仅是一个网络概念，还是一个服务概念，它构成了网络基础资源的一部分，提供了一种高端的数据传输服务和高速接入服务。数据中心提供给用户综合全面的解决方法，为政府上网、企业上网、企业IT管理提供专业服务，使企业和个人能够迅速借助网络开展业务，把精力集中在其核心业务策划和网站建设上，而减少IT方面的后顾之忧。</p>
<p>使用mininet中的iperf工具在网络中生成UDP流量，iperf客户端传送数据流到iperf的服务端，由服务端接收并记录相关信息。网络性能评估中一个巨大的挑战就是如何生成真实的网络流量，可以通过程序来创造人工的网络流量，通过建立测试环境来模拟真实的状况。此应用主要以数据中心网络为目标场景，在mininet仿真环境中尽可能地还原数据中心内部的真实流量情况。<br>Mininet数据中心应用价值：</p>
<ul>
<li>树状拓扑结构容错能力强</li>
<li>降低数据中心成本消耗</li>
<li>提供重新排列的全带宽无阻碍路径</li>
<li>提高带宽利用率</li>
<li>分析数据中心网络流量性能</li>
<li>为真实数据中心和仿真测试床提供有用信息</li>
</ul>
<p>在mininet中进行自定义命令iperfmulti功能拓展主要分为4步：</p>
<ol>
<li>修改mininet/net.py</li>
<li>修改mininet/cli.py</li>
<li>修改bin/mn</li>
<li>重新安装Mininet核心文件：~/mininet/util/install.sh -n</li>
</ol>
<h3 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h3><h4 id="一、编写网络测试程序"><a href="#一、编写网络测试程序" class="headerlink" title="一、编写网络测试程序"></a>一、编写网络测试程序</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 执行命令sudo vi openlab/mininet/mininet/net.py打开net.py文件,添加定义iperf_single()函数，实现在两个主机间进行iperf udp测试，并且在server端记录，具体代码如下，建议将代码放置在“def iperf”下</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">iperf_single</span>(<span class="params"> self,hosts=<span class="literal">None</span>, udpBw=<span class="string">&#x27;10M&#x27;</span>, period=<span class="number">60</span>, port=<span class="number">5001</span></span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Run iperf between two hosts using UDP.</span></span><br><span class="line"><span class="string">            hosts: list of hosts; if None, uses opposite hosts</span></span><br><span class="line"><span class="string">            returns: results two-element array of server and client speeds&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> hosts:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">assert</span> <span class="built_in">len</span>( hosts ) == <span class="number">2</span></span><br><span class="line">        client, server = hosts</span><br><span class="line">        filename = client.name[<span class="number">1</span>:] + <span class="string">&#x27;.out&#x27;</span></span><br><span class="line">        output( <span class="string">&#x27;*** Iperf: testing bandwidth between &#x27;</span> )</span><br><span class="line">        output( <span class="string">&quot;%s and %s\n&quot;</span> % ( client.name, server.name ) )</span><br><span class="line">        iperfArgs = <span class="string">&#x27;iperf -u &#x27;</span></span><br><span class="line">        bwArgs = <span class="string">&#x27;-b &#x27;</span> + udpBw + <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;***start server***&quot;</span></span><br><span class="line">        server.cmd( iperfArgs + <span class="string">&#x27;-s -i 1&#x27;</span> + <span class="string">&#x27; &gt; /home/sdnlab/log/&#x27;</span> + filename + <span class="string">&#x27;&amp;&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;***start client***&quot;</span></span><br><span class="line">        client.cmd(</span><br><span class="line">            iperfArgs + <span class="string">&#x27;-t &#x27;</span>+ <span class="built_in">str</span>(period) + <span class="string">&#x27; -c &#x27;</span> + server.IP() + <span class="string">&#x27; &#x27;</span> + bwArgs</span><br><span class="line">            +<span class="string">&#x27; &gt; /home/sdnlab/log/&#x27;</span> + <span class="string">&#x27;client&#x27;</span> + filename +<span class="string">&#x27;&amp;&#x27;</span>)</span><br><span class="line"><span class="comment">## 添加自定义命令iperfmulti()函数，iperfmulti函数主要是实现依次为每一台主机随机选择另一台主机作为iperf的服务器端，通过调用iperf_single，自身以客户端身份按照指定参数发送UDP流，服务器生成的报告以重定向的方式输出到文件中，使用iperfmulti命令，主机随机地向另一台主机发起一条恒定带宽的UDP数据流。具体代码如下所示,建议将代码放置在“def iperf_single”下</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">iperfMulti</span>(<span class="params">self, bw, period=<span class="number">60</span></span>):</span></span><br><span class="line">        base_port = <span class="number">5001</span></span><br><span class="line">        server_list = []</span><br><span class="line">        client_list = [h <span class="keyword">for</span> h <span class="keyword">in</span> self.hosts]</span><br><span class="line">        host_list = []</span><br><span class="line">        host_list = [h <span class="keyword">for</span> h <span class="keyword">in</span> self.hosts]</span><br><span class="line"></span><br><span class="line">        cli_outs = []</span><br><span class="line">        ser_outs = []</span><br><span class="line"></span><br><span class="line">        _<span class="built_in">len</span> = <span class="built_in">len</span>(host_list)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, _<span class="built_in">len</span>):</span><br><span class="line">            client = host_list[i]</span><br><span class="line">            server = client</span><br><span class="line">            <span class="keyword">while</span>( server == client ):</span><br><span class="line">                server = random.choice(host_list)</span><br><span class="line">            server_list.append(server)</span><br><span class="line">            self.iperf_single(hosts = [client, server], udpBw=bw, period= period, port=base_port)</span><br><span class="line">            sleep(<span class="number">.05</span>)</span><br><span class="line">            base_port += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        sleep(period)</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;test has done&quot;</span></span><br><span class="line"><span class="comment">## sudo vi openlab/mininet/mininet/cli.py,添加如下代码，注册iperfmulti命令</span></span><br><span class="line">    <span class="comment">## isReadable缩进有问题？</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isReadable</span>(<span class="params"> poller </span>):</span></span><br><span class="line">        <span class="string">&quot;Check whether a Poll object has a readable fd.&quot;</span></span><br><span class="line">        <span class="keyword">for</span> fdmask <span class="keyword">in</span> poller.poll( <span class="number">0</span> ):</span><br><span class="line">            mask = fdmask[ <span class="number">1</span> ]</span><br><span class="line">            <span class="keyword">if</span> mask &amp; POLLIN:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">do_iperfmulti</span>(<span class="params"> self, line </span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Multi iperf UDP test between nodes&quot;&quot;&quot;</span></span><br><span class="line">        args = line.split()</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(args) == <span class="number">1</span>:</span><br><span class="line">            udpBw = args[ <span class="number">0</span> ]</span><br><span class="line">            self.mn.iperfMulti(udpBw)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">len</span>(args) == <span class="number">2</span>:</span><br><span class="line">            udpBw = args[ <span class="number">0</span> ]</span><br><span class="line">            period = args[ <span class="number">1</span> ]</span><br><span class="line">            err = <span class="literal">False</span></span><br><span class="line">            self.mn.iperfMulti(udpBw, <span class="built_in">float</span>(period))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            error(<span class="string">&#x27;invalid number of args: iperfmulti udpBw period\n&#x27;</span> +</span><br><span class="line">                   <span class="string">&#x27;udpBw examples: 1M 120\n&#x27;</span>)</span><br><span class="line"><span class="comment">## 执行命令sudo vi openlab/mininet/bin/mn打开mn文件，在mn中加入iperfmulti可执行命令，如下所示</span></span><br><span class="line"></span><br><span class="line">TESTS = &#123; name: <span class="literal">True</span></span><br><span class="line">          <span class="keyword">for</span> name <span class="keyword">in</span> ( <span class="string">&#x27;pingall&#x27;</span>, <span class="string">&#x27;pingpair&#x27;</span>, <span class="string">&#x27;iperf&#x27;</span>, <span class="string">&#x27;iperfudp&#x27;</span>, <span class="string">&#x27;iperfmulti&#x27;</span> ) &#125;</span><br><span class="line"></span><br><span class="line">ALTSPELLING = &#123; <span class="string">&#x27;pingall&#x27;</span>: <span class="string">&#x27;pingAll&#x27;</span>, <span class="string">&#x27;pingpair&#x27;</span>: <span class="string">&#x27;pingPair&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;iperfudp&#x27;</span>: <span class="string">&#x27;iperfUdp&#x27;</span>,<span class="string">&#x27;iperfMulti&#x27;</span>:<span class="string">&#x27;iperfMulti&#x27;</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">## 执行如下命令，重新编译Mininet。</span></span><br><span class="line">$ cd openlab/mininet/util</span><br><span class="line">$./install.sh -n</span><br><span class="line"><span class="comment">## sudo mn命令创建一个topo，查看是否存在iperfmulti命令，以此验证iperfmulti是否成功</span></span><br></pre></td></tr></table></figure>

<h4 id="二、构建多数据中心网络拓扑"><a href="#二、构建多数据中心网络拓扑" class="headerlink" title="二、构建多数据中心网络拓扑"></a>二、构建多数据中心网络拓扑</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 执行如下命令，创建多数据中心拓扑创建脚本。</span></span><br><span class="line">$ cd /home/openlab/openlab/mininet/custom</span><br><span class="line">$ sudo vi fattree.py</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;Custom topology example</span></span><br><span class="line"><span class="string">Adding the &#x27;topos&#x27; dict with a key/value pair to generate our newly defined</span></span><br><span class="line"><span class="string">topology enables one to pass in &#x27;--topo=mytopo&#x27; from the command line.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> mininet.topo <span class="keyword">import</span> Topo</span><br><span class="line"><span class="keyword">from</span> mininet.net <span class="keyword">import</span> Mininet</span><br><span class="line"><span class="keyword">from</span> mininet.node <span class="keyword">import</span> RemoteController,CPULimitedHost</span><br><span class="line"><span class="keyword">from</span> mininet.link <span class="keyword">import</span> TCLink</span><br><span class="line"><span class="keyword">from</span> mininet.util <span class="keyword">import</span> dumpNodeConnections</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTopo</span>(<span class="params"> Topo </span>):</span></span><br><span class="line">    <span class="string">&quot;Simple topology example.&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params"> self </span>):</span></span><br><span class="line">        <span class="string">&quot;Create custom topo.&quot;</span></span><br><span class="line">        <span class="comment"># Initialize topology</span></span><br><span class="line">        Topo.__init__( self )</span><br><span class="line">        L1 = <span class="number">2</span></span><br><span class="line">        L2 = L1 * <span class="number">2</span> </span><br><span class="line">        L3 = L2</span><br><span class="line">        c = []</span><br><span class="line">        a = []</span><br><span class="line">        e = []</span><br><span class="line">        <span class="comment"># add core ovs  </span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>( L1 ):</span><br><span class="line">                sw = self.addSwitch( <span class="string">&#x27;c&#123;&#125;&#x27;</span>.<span class="built_in">format</span>( i + <span class="number">1</span> ) )</span><br><span class="line">                c.append( sw )</span><br><span class="line">        <span class="comment"># add aggregation ovs</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>( L2 ):</span><br><span class="line">                sw = self.addSwitch( <span class="string">&#x27;a&#123;&#125;&#x27;</span>.<span class="built_in">format</span>( L1 + i + <span class="number">1</span> ) )</span><br><span class="line">                a.append( sw )</span><br><span class="line">        <span class="comment"># add edge ovs</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>( L3 ):</span><br><span class="line">                sw = self.addSwitch( <span class="string">&#x27;e&#123;&#125;&#x27;</span>.<span class="built_in">format</span>( L1 + L2 + i + <span class="number">1</span> ) )</span><br><span class="line">                e.append( sw )</span><br><span class="line">        <span class="comment"># add links between core and aggregation ovs</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>( L1 ):</span><br><span class="line">                sw1 = c[i]</span><br><span class="line">                <span class="keyword">for</span> sw2 <span class="keyword">in</span> a[i/<span class="number">2</span>::L1/<span class="number">2</span>]:</span><br><span class="line">                <span class="comment"># self.addLink(sw2, sw1, bw=10, delay=&#x27;5ms&#x27;, loss=10, max_queue_size=1000, use_htb=True)</span></span><br><span class="line">                        self.addLink( sw2, sw1 )</span><br><span class="line">        <span class="comment"># add links between aggregation and edge ovs</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>( <span class="number">0</span>, L2, <span class="number">2</span> ):</span><br><span class="line">                <span class="keyword">for</span> sw1 <span class="keyword">in</span> a[i:i+<span class="number">2</span>]:</span><br><span class="line">                    <span class="keyword">for</span> sw2 <span class="keyword">in</span> e[i:i+<span class="number">2</span>]:</span><br><span class="line">                        self.addLink( sw2, sw1 )</span><br><span class="line">        <span class="comment">#add hosts and its links with edge ovs</span></span><br><span class="line">        count = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> sw1 <span class="keyword">in</span> e:</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                    host = self.addHost( <span class="string">&#x27;h&#123;&#125;&#x27;</span>.<span class="built_in">format</span>( count ) )</span><br><span class="line">                    self.addLink( sw1, host )</span><br><span class="line">                    count += <span class="number">1</span></span><br><span class="line">topos = &#123; <span class="string">&#x27;mytopo&#x27;</span>: ( <span class="keyword">lambda</span>: MyTopo() ) &#125;</span><br></pre></td></tr></table></figure>

<p>Mininet创建网络拓扑的代码中，可以通过改变代码中定义的L1变量来设置核心交换机的数量，并通过添加额外的交换机和链路来构成更复杂的数据中心网络拓扑。随着边缘交换机的增加，主机个数也随之增长，利用Mininet的易用性和扩展性，可以创建基于多种数据中心场景下的网络拓扑，达到更好更全面的实验效果。<br>说明：为方便用户实验，该段代码在/home/ftp/fattree.py文件中已预置。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 切换到Mininet主机，执行如下命令，启动Mininet，生成测试拓扑结构。</span></span><br><span class="line">sudo mn --custom fattree.py --topo mytopo --controller=remote,ip=119.255.243.31,port=6633 --switch ovs,protocols=OpenFlow13</span><br></pre></td></tr></table></figure>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://shizhonggan.github.io/2021/04/21/SDN/SDN04_Mininet/" title="软件定义网络（SDN）学习笔记(4)--Mininet" target="_blank" rel="external">http://shizhonggan.github.io/2021/04/21/SDN/SDN04_Mininet/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="https://ganshizhong.gitee.io/blogimages/HexoSource/me.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">甘士忠</span><small class="ml-1x">Sharing is meaningful.</small></a></h3>
        <div>Long life and long code.</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/04/26/Python/ObjectOrientedPrograming/" title="面向对象编程(python)"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/04/21/SDN/SDN03_ovs/" title="软件定义网络（SDN）学习笔记(3)--OVS系统架构"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <!-- <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button> -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat" data-mobile-sites="weibo,qq"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="https://ganshizhong.gitee.io/blogimages/HexoSource/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="https://ganshizhong.gitee.io/blogimages/HexoSource/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/shizhonggan" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://gitee.com/ganshizhong" target="_blank" title="Gitee" data-toggle=tooltip data-placement=top><i class="icon icon-gitee"></i></a></li>
        
    </ul>

    <div class="copyright">

    	
        &copy; 2022 甘士忠
        
        <!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> -->
        <!-- <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span> -->
        <!-- <div class="publishby">
        	Theme by <a href="https://github.com/shizhonggan" target="_blank"> 甘士忠 </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div> -->
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





   






</body>
</html>